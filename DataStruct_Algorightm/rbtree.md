# 红黑树
二叉树在极端情况下会退化成链表，时间复杂度退化到 O(n)

## 平衡二叉树
二叉树中任意一个节点的左右子树的高度相差不大于 1

完全二叉树（叶节点在最底下两层，最后一层叶节点靠左排列，并且除了最后一层其他层的节点个数都要达到最大；数组方式存储时没有空间的浪费）、满二叉树（叶节点全部在最底层，除了叶节点之外，每个节点都有左右两个子节点）都是平衡二叉树，非完全二叉树也有可能是平衡二叉树

## 平衡二叉查找树
平衡就是让整个树左右看起来比较对称、比较平衡，不出现左子树很高、右子树很矮的情况，这样能让整棵树的高度相对来说低一些，相应的插入、删除、查找等操作效率高一些；只要树的高度不比 log2n 大很多（仍是对数量级）

## 红黑树
它是一种不严格的平衡二叉查找树

- 红黑树中的节点一类被标记为黑色，一类被标记为红色；
- 根节点是黑色的；
- 每个叶子节点都是黑色的空节点，即叶子节点不存储数据；
- 任何相邻的节点都不能同时为红色，即红色节点都是被黑色节点隔开的；
- 每个节点，从该节点到达其可达叶子节点的所有路径，都包含相同数目的黑色节点

红黑树高度近似 2log2n，它的插入、删除、查找等操作时间复杂度是 O(logn)

因为红黑树是一种性能稳定的二叉查找树，所以但凡用到动态插入、删除、查找数据的场景，都可以用到它

### 左旋、右旋
左旋：围绕某个节点的左旋

右旋：围绕某个节点的右旋

![](../Picture/DataStruct/rbtree/01.jpg)

### 插入操作的平衡调整
规定：插入的节点必须是红色的，而且二叉树中新插入的节点都是放在叶子节点上
1. 如果插入节点的父节点是黑色的，那什么都不用做
2. 如果插入节点是根节点，那改变它的颜色，变成黑色
3. 此外所有操作都会违背红黑树定义，故需要调整，调整过程包含两种基础操作：左右旋和改变颜色；新节点插入之后，如果红黑树的平衡被打破，只需要根据每种情况的特定不停调整，就可以让红黑树保持平衡

父节点的兄弟节点—叔叔节点

父节点的父节点——祖父节点

正在处理的节点——关注节点

情况1：关注节点a的叔叔节点d是红色
1. 将关注节点 a 的父亲节点 b、叔叔节点d的颜色都设置成黑色
2. 关注节点的祖父节点 c 设置成红色
3. 关注节点变成祖父节点 c

![](../Picture/DataStruct/rbtree/02.jpg)

情况2：关注节点 a 的叔叔节点 d 是黑色，a 是父节点 b 的右子节点
1. 关注节点变成父节点 b
2. 围绕关注节点 b 左旋
3. 调到情况 3

![](../Picture/DataStruct/rbtree/03.jpg)

情况3：关注节点 a 的叔叔节点 d 是黑色，a 是父节点 b 的左子节点
1. 围绕 a 的祖父节点 c 右旋
2. 将 a 的父节点 b、兄弟节点 c 的颜色互换

![](../Picture/DataStruct/rbtree/04.jpg)

### 删除操作的平衡调整
第一步是针对删除节点初步调整，只是保证整颗红黑树在一个节点删除之后，每个节点达到其可达叶子节点的所有路径包含相同数目的黑色节点

第二步是针对关注节点进行二次调整，即不存在相邻的两个红色节点

初步调整
情况一：
